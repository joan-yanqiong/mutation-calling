
profiles {
    slurm {
        process {
            executor='slurm'
            withName: BUILD_INDEX {
                time = '0-10:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=BUILD_INDEX'
            }
            withName: MAP_READS {
                time = '0-10:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=MAP_READS'
            }

            withName: ADD_READ_GROUPS {
                time = '0-6:00'
                cpus = 6
                memory = '4GB'
                queue = 'all'
                clusterOptions = '--job-name=ADD_READ_GROUPS'
            }

            withName: INDEX_DNA {
                time = '0-10:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=INDEX_DNA'
            }

            withName: MARK_DUPLICATES {
                time = '0-6:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=MARK_DUPLICATES'
            }
            withName: SPLIT_CIGARS {
                time = '0-6:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=SPLIT_CIGARS'
            }

            withName: BQSR_TABLE {
                time = '0-10:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=BQSR_TABLE'
            }

            withName: APPLY_BQSR {
                time = '0-10:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=APPLY_BQSR'
            }
            withName: MUTECT {
                time = '0-10:00'
                cpus = 6
                memory = '40GB'
                queue = 'himem'
                clusterOptions = '--job-name=MUTECT'
            }
        }
    }


    local_docker {
        docker.enabled = true
        process {
            containerOptions = '--volume /Users/joankant/Library/CloudStorage/OneDrive-UHN/Coding/local-cell-cell-interactions:/project'
            executor = 'local'
            container = 'gbm_cci'
            withName: PREPROCESSING {
                errorStrategy = 'ignore'
            }

        }
    }

    slurm_apptainer {
        apptainer.enabled = true
        apptainer.autoMounts = true
        apptainer.runOptions='--bind /cluster/projects/gaitigroup/Users/Joan/h4h-cell-cell-interactions:/project'
        process {
            container='/cluster/home/t119972uhn/images/gbm_cci.sif'
            executor='slurm'
            withName: PREPROCESSING {
                errorStrategy = 'ignore'
            }
            withName: GET_METADATA {
                time = '00:10:00'
                memory = '32GB'
                cpus = 1
                queue = 'himem'
                clusterOptions = '--job-name=000_prep_get_metadata'
            }
            withName: SPLIT_SAMPLES {
                time = '05:00:00'
                memory = '64GB'
                cpus = 1
                queue = 'veryhimem'
                clusterOptions = '--job-name=001_prep_split_samples'
            }

            withName: PREPARE_SAMPLE {
                time = '00:15:00'
                memory = '32GB'
                cpus = 1
                queue = 'himem'
                clusterOptions = '--job-name=002_prep_sample'
            }

            withName: PREPROCESSING {
                time = '00:15:00'
                memory = '32GB'
                cpus = 1
                queue = 'himem'
                clusterOptions = '--job-name=100_preprocessing'
                errorStrategy = 'ignore'

            }

            withName: INFER_CELLCHAT {
                time = '12:00:00'
                memory = '128GB'
                cpus = 1
                queue = 'veryhimem'
                clusterOptions = '--job-name=200_cci_cellchat'
            }

            withName: INFER_LIANA {
                time = '12:00:00'
                memory = '128GB'
                cpus = 1
                queue = 'veryhimem'
                clusterOptions = '--job-name=201_cci_liana'
            }

            withName: INFER_CELL2CELL {
                time = '36:00:00'
                memory = '32GB'
                cpus = 1
                queue = 'himem'
                clusterOptions = '--job-name=202_cci_cell2cell'
            }
            withName: POSTPROCESSING_CELLCHAT {
                time = '01:00:00'
                memory = '64GB'
                cpus = 1
                queue = 'veryhimem'
                clusterOptions = '--job-name=300_postprocessing_cellchat'
            }
            withName: POSTPROCESSING_LIANA {
                time = '00:10:00'
                memory = '32G'
                cpus = 1
                queue = 'himem'
                clusterOptions = '--job-name=301_postprocessing_liana'
            }

            withName: POSTPROCESSING_CELL2CELL {
                time = '00:10:00'
                memory = '32G'
                cpus = 1
                queue = 'himem'
                clusterOptions = '--job-name=302_postprocessing_cell2cell'
            }

        }
    }

    standard {
        conda.enabled=true
        process {
            executor = 'local'
            conda = '/Users/joankant/miniforge-pypy3/envs/cci_env'
            withName: PREPROCESSING {
                errorStrategy = 'ignore'
            }

        }
    }
}
